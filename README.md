<h1>Vulnerability Management Lab</h1>

<h2>Description</h2>
The project showcases why a vulnerability scanner such as Nessus can be extremely useful and necessary. We set up a vulnerable machine and added an outdated version of Firefox to show the differences between the scans. We then took the information we gained from the scans and started with some vulnerability remediation. We will use 1 Virtual Machine (VM) which will be our vulnerable host, and my personal computer installed with Windows 11 to complete the Nessus scans on.
<br />


<h2>Languages and Utilities Used</h2>

- <b>Tennable Nesus Essentials</b>

<h2>Environments Used </h2>

- <b>Windows 10 Pro</b>
- <b>Windows 11 (Host Machine)</b>
- <b>VMware Workstation Pro</b>

<h2>Walk-through:</h2>

Setup for the Windows 10 Vulnerable Host:<br/>
<br/>
Network Adapter: Bridged<br/>
At least 2048 (2 GB) (I did 4 GB just to speed it up a little) base memory<br/>
The more processor core the better (I did 4 for this, but make sure your computer can handle it) <br />
<img src="https://github.com/user-attachments/assets/23b477d9-862d-4092-86dc-5fc8ccab6593"/>
<br />
<br />
Go through a normal setup for Windows 10 and start up the VM. <br />
Once completed, start it up and open up the Command Prompt, in that command prompt use "ipconfig" to find the IP address of the VM, this is the IP address that we will be testing. (Mine is 192.168.1.45)
<img src="https://github.com/user-attachments/assets/98b37d62-1135-4c84-8f1a-efafd1b58ec6"/>
<br />
<br />
Now, on our personal machine, I will try and continuously ping the VM IP address to make sure that we can connect with it. As you can see, we are not able to connect
<img src="https://github.com/user-attachments/assets/c717f67a-e76a-4322-b011-a988c1830713"/>
<br />
<br />
To allow our vulnerable machine to talk to our personal machine, we have to turn off the Windows Firewall. We can do this by typing in "wf.msc" to quickly go to our firewall settings
<img src="https://github.com/user-attachments/assets/d552141f-904f-4589-a452-f87cc29d48c9"/>
<br />
<br />
On the Windows Defender Firewall, we can see that all of the firewalls are on. Click on "Windows Defender Firewall Properties"
<img src="https://github.com/user-attachments/assets/a901c9af-b276-46d0-bc6b-ee015e4a2798"/>
<br />
<br />
Go to each tab (Domain, Private, and Public Profile) and turn the "Firewall state:" to "Off". Click "Apply" and then "OK"
<img src="https://github.com/user-attachments/assets/866e8e31-9317-4205-8586-e1b058167804"/>
<br />
<img src="https://github.com/user-attachments/assets/c5f73700-255d-48a3-8005-df1ab199ec54"/>
<br />
<img src="https://github.com/user-attachments/assets/8c8d97ad-9971-4c2d-8366-9a90a14e313e"/>
<br />
<br />
We can see now that all 3 Defender Firewalls are turned off
<img src="https://github.com/user-attachments/assets/64d0001b-7a93-45de-82e0-7c2e59d896f4"/>
<br />
<br />
Now that the firewalls are off, we can go back to our host machine and see that the continuous ping is now going through and we are getting replies. This means our vulnerable machine and host machine can now talk over the bridged connection
<img src="https://github.com/user-attachments/assets/0dc3058d-f5e4-4bf2-8c12-6dec6f2aaed3"/>
<br />
<br />
Let's open up our Nessus Essential dashboard on our personal machine, click "New Scan"
<img src="https://github.com/user-attachments/assets/3f880d9d-0645-4541-b717-73afbc2de8b4"/>
<br />
<br />
We will be doing just a "Basic Network Scan" but Nessus does offer a ton of options that you can choose from
<img src="https://github.com/user-attachments/assets/4713b2ce-7411-4ad7-8cab-21f153957353"/>
<br />
<br />
Now we will set the name, I chose "Windows 10 Single Host" to make it easy, and then put our target vulnerable machine IP address in the "Target" field
<img src="https://github.com/user-attachments/assets/08609de9-abcc-4070-8b15-82c470b57fec"/>
<br />
<br />
We can look around and see that we can change the port scan, we will just be using the "Port scan (common ports)" for this scan
<img src="https://github.com/user-attachments/assets/bcc84d38-cf04-4091-a69b-83b7ae1da9cd"/>
<br />
<br />
We can also go to the "Credentials" tab to see that we can do a Windows or SSH credential scan, for our first scan we will use without credentials. Click "Save" and go back to "My Scans"
<img src="https://github.com/user-attachments/assets/db6ef392-13d8-4f83-b9bd-9ba51450350a"/>
<br />
<br />
Click "Launch" to start the scan
<img src="https://github.com/user-attachments/assets/663bacc7-792d-4989-80b4-f92fa61f7135"/>
<br />
<br />
We can see that the scan is in progress, it might take a couple of minutes to complete
<img src="https://github.com/user-attachments/assets/c26db39f-126f-46eb-8c68-f3553f90449a"/>
<br />
<br />
Now that it is completed, we can click on the scan and this page comes up. We can see that we have a few low and medium vulnerabilities and a decent amount of info
<img src="https://github.com/user-attachments/assets/e8b98ec6-5f26-4ef7-a6a0-f9fab14db3fa"/>
<br />
<br />
We can click on the "Vulnerability" tab we can see a list of the vulnerabilities that were found, if we click on one it will open up more information about that vulnerability
<img src="https://github.com/user-attachments/assets/05feeb5b-cc1c-4f83-965d-94d737b0d88d"/>
<br />
<br />
This is an example of one of the vulnerabilities, it tells us the description of the vulnerability and a solution to fix it
<img src="https://github.com/user-attachments/assets/99c2b401-7214-4aec-bd59-02b861b7a5ed"/>
<br />
<br />
Now we will do the setup for the second scan, we are going to be doing a credentialed scan that will go more in-depth. <br />
On the VM, open up "Services"
<img src="https://github.com/user-attachments/assets/55da2508-4cc0-431f-a000-4b715968e775"/>
<br />
<br />
Now we will navigate down to "Remote Registry" and double-click on it
<img src="https://github.com/user-attachments/assets/3b3df31e-fde3-43a6-9a06-d592b763d472"/>
<br />
<br />
Here we will set the "Startup type:" to "Automatic" and click "Start" and then "OK"
<img src="https://github.com/user-attachments/assets/01592947-aa7e-4ad3-861f-6346d657be84"/>
<br />
<br />
Now we can see that Remote Registry is now "Running"
<img src="https://github.com/user-attachments/assets/57987c65-be7f-4c26-9056-41486aa8dc4a"/>
<br />
<br />
Now we will make sure our file and printer sharing is on, open up "Manage advanced sharing settings"
<img src="https://github.com/user-attachments/assets/ad39d66c-6c3e-4a98-84a7-1c545a58c3e3"/>
<br />
<br />
Mine was already turned on for this VM but make sure that these are turned on
<img src="https://github.com/user-attachments/assets/d75da6ab-09af-4b3d-913b-631f0e05c59e"/>
<br />
<br />
Now we will open "Change User Account Control settings"
<img src="https://github.com/user-attachments/assets/93c1b9ae-de39-41cf-8347-966c92a23808"/>
<br />
<br />
I would not recommend doing this on a corporate device but we will do it on here, set the notifications to "Never notify" and click "OK"
<img src="https://github.com/user-attachments/assets/2f3c8e5c-77ff-4900-ab73-652ca33740d1"/>
<br />
<br />
It will prompt you to admin allow this decision, just click "Yes"
<img src="https://github.com/user-attachments/assets/7c710e65-1409-44d0-89e4-1ede9314aa08"/>
<br />
<br />
Now we will open up our Registry Editor
<img src="https://github.com/user-attachments/assets/9fb48676-e743-48bb-ba2c-54f4b03c5972"/>
<br />
<br />
We will go to the following file path: HKEY_LOCAL_MACHINE > SOFTWARE > Microsoft > Windows > CurrentVersion > Policies > System
<img src="https://github.com/user-attachments/assets/67d347c3-b83f-41c6-8314-3b6bac5698ce"/>
<br />
<br />
Right-click in the open area and go to "New" and then "DWORD (32-bit) Value
<img src="https://github.com/user-attachments/assets/9794f057-692b-4b41-88c2-93ebc9be00fc"/>
<br />
<br />
The name should be as follows "LocalAccountTokenFilterPolicy", press Enter and then double-click on the policy you just made
<img src="https://github.com/user-attachments/assets/ff714a03-672e-4462-8bef-c17440256e18"/>
<br />
<br />
In the window that pops up, enter "1" into the "Value Size" and click "OK"
<img src="https://github.com/user-attachments/assets/e1b92534-69f8-4297-9809-ad14f08bc9be"/>
<br />
<br />
Go ahead and restart the VM and sign back in
<img src="https://github.com/user-attachments/assets/089523ff-544c-4ff4-bf4e-b5576def8efe"/>
<br />
<br />
On our VM, type the command "whoami" in the Command Prompt to find the user name
<img src="https://github.com/user-attachments/assets/ddf51577-b3f5-4761-a7c6-34536dfc8d7e"/>
<br />
<br />
On Nessus, check the box next to your scan and go to "More" and click on "Configure"
<img src="https://github.com/user-attachments/assets/71c88f46-e3e4-42ab-8e27-b5725b25412c"/>
<br />
<br />
Under the credential tab, we will enter the Username that we found from the "whoami" command as well as the password to log into the VM. We can leave the other checkboxes as they are for now
<img src="https://github.com/user-attachments/assets/e3dbe144-32e2-4ac3-97cc-2e51db9cea54"/>
<br />
<br />
Scroll down and click "Save"
<img src="https://github.com/user-attachments/assets/46bd29fe-9451-4036-9dba-521a511f8bd8"/>
<br />
<br />
Go back to "My Scans" and click "Launch"
<img src="https://github.com/user-attachments/assets/9ca69778-aeea-44e0-ae54-3bf735358198"/>
<br />
<br />
After the scan completes, we can click on it and see that we have quite a few more vulnerabilities
<img src="https://github.com/user-attachments/assets/a43cef8d-1e3d-4843-959a-f4a8837fb2fa"/>
<br />
<br />
If we go to memory we can look at the difference between our last 2 scans, here is the first one
<img src="https://github.com/user-attachments/assets/7b5fb302-c15c-41f8-86c7-063f1f926c5f"/>
<br />
<br />
Here is the second one with the credentialed scan, in our pie chart we can see a big difference in the percentage of vulnerabilities to info
<img src="https://github.com/user-attachments/assets/69d9632c-51ff-4001-9b23-4ee4973b7ee5"/>
<br />
<br />
If we go to the "Vulnerabilities" tab there are a lot more vulnerabilities, we can go into each of these folders to find exactly what the vulnerability is and what some solutions are to fix them
<img src="https://github.com/user-attachments/assets/d9b9d1d4-e01b-44e6-85c5-26d98b6dfd25"/>
<br />
<br />
We can also go to the "Remediations" tab which will give us some great steps to remediate all of our issues in a few steps
<img src="https://github.com/user-attachments/assets/d12ae4eb-b4f3-4ec6-b8fa-95a4d712e41b"/>
<br />
<br />
Now I will go ahead and download an outdated Firefox (Firefox 3.6.12) browser on our VM to test our scanner
<img src="https://github.com/user-attachments/assets/a4f1721b-3f1b-44e6-91f4-07c3c62e40e7"/>
<br />
<br />
Here I am just going through the download process
<img src="https://github.com/user-attachments/assets/6024b86c-910d-4425-8762-bcfde876682b"/>
<br />
<br />
Here is just finishing the download
<img src="https://github.com/user-attachments/assets/e6952af5-380e-4ea6-b455-2733e2403701"/>
<br />
<br />
Now we can see that we have a very outdated version of Firefox running on our VM
<img src="https://github.com/user-attachments/assets/571e5ef5-4535-4d16-93a8-2fd568865ea4"/>
<br />
<br />
Back on our Nessus Essentials, we will just launch the same scan
<img src="https://github.com/user-attachments/assets/b570c912-1c73-437b-b0f0-15babe53109d"/>
<br />
<br />
Once completed, we can see that we have an astounding amount of vulnerabilities
<img src="https://github.com/user-attachments/assets/e3c1d940-d3c8-4ce9-af41-3c4f4a56869b"/>
<br />
<br />
Under our vulnerabilities, we can now see Mozilla Firefox at the top with a count of 185. This is good, it means that our Nessus scan is seeing the information that we want it to
<img src="https://github.com/user-attachments/assets/e6d5b45f-3a63-4db3-9395-3477e51a9acb"/>
<br />
<br />
If we click on our Firefox issue folder, it seems like the majority of these issues are coming from it being out-of-date
<img src="https://github.com/user-attachments/assets/77a58699-3dd0-4fc4-aff1-db6f058aa372"/>
<br />
<br />
Under our "Remediations" tab, we see at the very top that we need to upgrade Firefox to 13.0 or later
<img src="https://github.com/user-attachments/assets/2bbdbd1a-a86c-481c-8d59-ac1ec81c1056"/>
<br />
<br />
Now we will do some basic remediation! <br />
On our VM we will open up "appwiz.cpl"
<img src="https://github.com/user-attachments/assets/b9c2c4d3-90c2-4305-b69b-a3ef2994381a"/>
<br />
<br />
We can update Firefox, but I am just choosing to uninstall it
<img src="https://github.com/user-attachments/assets/6af945b8-0537-4795-b861-05c5594618c5"/>
<br />
<br />
Here we are just going through the uninstall process
<img src="https://github.com/user-attachments/assets/aecfb7ab-6b90-42fd-832d-568df3f4c91c"/>
<br />
<br />
Now we will try and remediate another big chunk of our vulnerabilities by making sure that Windows is up to date, enter "Check for updates" in the start menu
<img src="https://github.com/user-attachments/assets/b9575bdf-5c96-465a-8321-8c5416de7702"/>
<br />
<br />
Here just click "Check for Updates"
<img src="https://github.com/user-attachments/assets/92617a5b-77c3-4478-96ca-e90362657274"/>
<br />
<br />
Just wait for all of these to finish updating
<img src="https://github.com/user-attachments/assets/8ef64d04-221e-4a0c-89a4-7f5d905db319"/>
<br />
<br />
Go ahead and restart to complete the updates
<img src="https://github.com/user-attachments/assets/4544dcfb-4bbb-4de8-96aa-6684ffa95ffa"/>
<br />
<br />
After restart, sign back in as normal
<img src="https://github.com/user-attachments/assets/1339d826-970f-4cc4-a34a-470418bba4b1"/>
<br />
<br />
Open the Windows update again, and click "Check for updates" again
<img src="https://github.com/user-attachments/assets/c1a67873-e6b0-460a-8dae-f4e37217ed03"/>
<br />
<br />
Allow this to complete the updates
<img src="https://github.com/user-attachments/assets/4cd99a60-43a9-4a04-89a6-2d50030f628b"/>
<br />
<br />
Now that it says "You're up to date" we can check one more time just to make sure that all updates are complete 
<img src="https://github.com/user-attachments/assets/4cd99a60-43a9-4a04-89a6-2d50030f628b"/>
<br />
<br />
Back on our personal machine, we will "Launch" another scan
<img src="https://github.com/user-attachments/assets/ca1a05aa-6f81-4f71-b344-d1430522a4a3"/>
<br />
<br />
After it is complete we can see that we are back down to a much lower amount of vulnerabilities
<img src="https://github.com/user-attachments/assets/3538e51f-28c0-40aa-b6e6-a479261d1f19"/>
<br />
<br />
In our "History" tab we can see that the pie-chart of vulnerabilities is looking much better than before
<img src="https://github.com/user-attachments/assets/fe115165-7c99-404b-a795-d29d767787b8"/>
<br />
<br />
Here is the comparison from before we did our remediation
<img src="https://github.com/user-attachments/assets/05bb944d-8f44-4593-b9cd-b8aa5e9bff44"/>
<br />
<br />
Back on our remediation page it is looking much more manageable, we would more than likely need to update these last few things individually to completely clear up our scan
<img src="https://github.com/user-attachments/assets/3b7f8fa5-702d-4293-ae92-d981ee2a4418"/>
<br />
<br />
On our "Vulnerabilities" page all we have left is some Microsoft Windows vulnerabilities
<img src="https://github.com/user-attachments/assets/cd239d0b-83a8-4cc5-93a8-de1fa045a551"/>
<br />
<br />
If we click on the top one, we can see more of the specific issues that are associated with the Windows vulnerabilities, this would more than likely be fixed with a simple update
<img src="https://github.com/user-attachments/assets/7253c625-ecfa-4df4-9bae-276344a581f1"/>
<br />
<br />

